name: skillet_panorama_dgstack_notshared_v10_0

label: Panorama Notshared DGStack IronSkillet 10.0

description: group of snippets for ironskillet 10.0 panorama notshared dgtemplate

    configuration

type: panorama

labels:

    collection:
    - IronSkillet

variables:

-   name: STACK
    description: Template stack name for Panorama
    default: sample_stack
    type_hint: text
    help_text: creates a sample template stack with IronSkillet configuration elements

-   name: DEVICE_GROUP
    description: Device-group name for Panorama
    default: sample_devicegroup
    type_hint: text
    help_text: creates a sample device-group with IronSkillet configuration elements

-   name: EMAIL_PROFILE_GATEWAY
    description: email gateway address for critical alerts
    default: 192.0.2.1
    type_hint: text
    help_text: email server profile configuration under Device --> Server Profiles

-   name: EMAIL_PROFILE_FROM
    description: from address in email alerts
    default: sentfrom@yourdomain.com
    type_hint: text
    help_text: email server profile configuration under Device --> Server Profiles

-   name: EMAIL_PROFILE_TO
    description: to address in email alerts
    default: sendto@yourdomain.com
    type_hint: text
    help_text: email server profile configuration under Device --> Server Profiles

-   name: SYSLOG_SERVER
    description: syslog server ip address
    default: 192.0.2.2
    type_hint: text

-   name: FW_NAME
    description: Device Name for NGFW
    default: sample
    type_hint: text

-   name: MGMT_TYPE
    description: firewall management IP type
    default: dhcp-client
    type_hint: dropdown
    dd_list:
    -   key: dhcp-client
        value: dhcp-client
    -   key: static
        value: static

-   name: MGMT_IP
    description: NGFW management IP
    default: 192.0.2.6
    type_hint: ip_address
    toggle_hint:
        source: MGMT_TYPE
        value: static

-   name: MGMT_MASK
    description: NGFW management netmask
    type_hint: ip_address
    default: 255.255.255.0
    toggle_hint:
        source: MGMT_TYPE
        value: static

-   name: MGMT_DG
    description: NGFW management default gateway
    default: 192.0.2.7
    type_hint: ip_address
    toggle_hint:
        source: MGMT_TYPE
        value: static

-   name: NTP_1
    description: primary NTP server
    default: 0.pool.ntp.org
    type_hint: text

-   name: NTP_2
    description: secondary NTP server
    default: 1.pool.ntp.org
    type_hint: text

-   name: DNS_1
    description: primary dns server
    default: 8.8.8.8
    type_hint: ip_address

-   name: DNS_2
    description: secondary dns server
    default: 8.8.4.4
    type_hint: ip_address

-   name: API_KEY_LIFETIME
    description: lifetime for the api key in minutes
    default: 525600
    type_hint: text
    help_text: sets the expiration period for generated API keys

-   name: ADMINISTRATOR_USERNAME
    description: admin username
    default: adminuser
    type_hint: text
    help_text: if the user opts out of the Panorama admin config, this user will still
        be applied as a firewall adminstrator

-   name: ADMINISTRATOR_PASSWORD
    description: admin password
    default: adminuser
    type_hint: password
    help_text: if the user opts out of the Panorama admin config, this password will
        still be applied to the firewall administrator

-   name: SINKHOLE_IPV4
    description: sinkhole FQDN IPv4
    default: sinkhole.paloaltonetworks.com
    type_hint: text
    help_text: FQDN value for the IPV4 sinkhole address used in the anti-spyware security
        profile

-   name: SINKHOLE_IPV6
    description: sinkhole address IPv6
    default: 2600:5200::1
    type_hint: ip_address
    help_text: IP address for the IPv6 sinkhole used in the anti-spyware security
        profile

-   name: INCLUDE_PAN_EDL
    description: include the predefined Palo Alto Networks external lists security
        rules
    default: 'no'
    type_hint: dropdown
    help_text: a valid threat license and content updates are required to access the
        panw external-lists used in the rules
    dd_list:
    -   key: 'yes'
        value: 'yes'
    -   key: 'no'
        value: 'no'

snippets:

-   name: panorama_template_10_0.ironskillet_template
    xpath: /config/devices/entry[@name='localhost.localdomain']/template
    element: |-
        <entry name="iron-skillet">
          <settings>
            <default-vsys>vsys1</default-vsys>
          </settings>
          <config>
            <devices>
              <entry name="localhost.localdomain">
                <vsys>
                  <entry name="vsys1"/>
                </vsys>
              </entry>
            </devices>
          </config>
        </entry>
    cmd: set

-   name: panorama_template_stack_10_0.ironskillet_template_stack
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack
    element: |-
        <entry name="{{STACK}}">
          <templates>
            <member>iron-skillet</member>
          </templates>
          <settings>
            <default-vsys>vsys1</default-vsys>
          </settings>
            <config>
              <devices>
                <entry name="localhost.localdomain">
                  <vsys>
                    <entry name="vsys1"/>
                  </vsys>
                </entry>
              </devices>
          </config>
        </entry>
    cmd: set

-   name: panorama_log_settings_10_0.ironskillet_log_settings_email_profile
    xpath: /config/panorama/log-settings
    element: |-
        <email>
          <entry name="Sample_Email_Profile">
            <server>
              <entry name="Sample_Email_Profile">
                <display-name>Threat_Alerts</display-name>
                <gateway>{{ EMAIL_PROFILE_GATEWAY }}</gateway>
                <from>{{ EMAIL_PROFILE_FROM }}</from>
                <to>{{ EMAIL_PROFILE_TO }}</to>
                <protocol>SMTP</protocol>
              </entry>
            </server>
          </entry>
        </email>
    cmd: set

-   name: panorama_log_settings_10_0.ironskillet_log_settings_syslog_profile
    xpath: /config/panorama/log-settings
    element: |-
        <syslog>
          <entry name="Sample_Syslog_Profile">
            <server>
              <entry name="Sample_Syslog">
                <transport>UDP</transport>
                <port>514</port>
                <format>BSD</format>
                <server>{{ SYSLOG_SERVER }}</server>
                <facility>LOG_USER</facility>
              </entry>
            </server>
          </entry>
        </syslog>
    cmd: set

-   name: panorama_log_settings_10_0.ironskillet_log_settings_critical_system
    xpath: /config/panorama/log-settings
    element: |-
        <system>
          <match-list>
            <entry name="Critical_System_Log_Email">
              <send-email>
                <member>Sample_Email_Profile</member>
              </send-email>
              <filter>(severity eq critical)</filter>
            </entry>
            <entry name="System_Log_Forwarding">
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
              <filter>All Logs</filter>
            </entry>
          </match-list>
        </system>
    cmd: set

-   name: panorama_log_settings_10_0.ironskillet_log_settings_log_forwarding
    xpath: /config/panorama/log-settings
    element: |-
        <config>
          <match-list>
            <entry name="Configuration_Log_Forwarding">
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
              <filter>All Logs</filter>
            </entry>
          </match-list>
        </config>
    cmd: set

-   name: panorama_log_settings_10_0.ironskillet_log_settings_userid_forwarding
    xpath: /config/panorama/log-settings
    element: |-
        <userid>
          <match-list>
            <entry name="User-ID_Log_Forwarding">
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
              <filter>All Logs</filter>
            </entry>
          </match-list>
        </userid>
    cmd: set

-   name: panorama_device_system_local_10_0.ironskillet_device_system_hostname
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{
        STACK }}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: <hostname>{{ FW_NAME }}</hostname>
    cmd: set

-   name: panorama_device_system_local_10_0.ironskillet_device_system_mgmt_type
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{
        STACK }}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        {%- if MGMT_TYPE == "static" %}
        <type>
          <static/>
        </type>
        <ip-address>{{ MGMT_IP }}</ip-address>
        <netmask>{{ MGMT_MASK }}</netmask>
        <default-gateway>{{ MGMT_DG }}</default-gateway>
        {% elif MGMT_TYPE == "dhcp-client" %}
        <type>
           <dhcp-client>
             <send-hostname>yes</send-hostname>
             <send-client-id>no</send-client-id>
             <accept-dhcp-hostname>no</accept-dhcp-hostname>
             <accept-dhcp-domain>no</accept-dhcp-domain>
           </dhcp-client>
        </type>
        {% else %}
        <type>
           <dhcp-client>
             <send-hostname>yes</send-hostname>
             <send-client-id>no</send-client-id>
             <accept-dhcp-hostname>no</accept-dhcp-hostname>
             <accept-dhcp-domain>no</accept-dhcp-domain>
           </dhcp-client>
        </type>
        {% endif %}
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_dynamic_updates
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <update-schedule>
          <threats>
            <recurring>
              <every-30-mins>
                <at>2</at>
                <action>download-and-install</action>
              </every-30-mins>
              <threshold>48</threshold>
            </recurring>
          </threats>
          <anti-virus>
            <recurring>
              <hourly>
                <at>4</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </anti-virus>
          <wildfire>
            <recurring>
              <real-time/>
            </recurring>
          </wildfire>
          <global-protect-datafile>
            <recurring>
              <hourly>
                <at>40</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </global-protect-datafile>
          <global-protect-clientless-vpn>
            <recurring>
              <hourly>
                <at>50</at>
                <action>download-and-install</action>
              </hourly>
            </recurring>
          </global-protect-clientless-vpn>
        </update-schedule>
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_snmp
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <snmp-setting>
          <access-setting>
            <version>
              <v3/>
            </version>
          </access-setting>
        </snmp-setting>
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_dns
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <dns-setting>
          <servers>
            <primary>{{ DNS_1 }}</primary>
            <secondary>{{ DNS_2 }}</secondary>
          </servers>
        </dns-setting>
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_ntp
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <ntp-servers>
          <primary-ntp-server>
            <ntp-server-address>{{ NTP_1 }}</ntp-server-address>
          </primary-ntp-server>
          <secondary-ntp-server>
            <ntp-server-address>{{ NTP_2 }}</ntp-server-address>
          </secondary-ntp-server>
        </ntp-servers>
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_login_banner
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: |-
        <login-banner>You have accessed a protected system.
        Log off immediately if you are not an authorized user.</login-banner>
    cmd: set

-   name: panorama_device_system_shared_10_0.ironskillet_device_system_timezone
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/system
    element: <timezone>UTC</timezone>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_ctd
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <ctd>
          <tcp-bypass-exceed-queue>no</tcp-bypass-exceed-queue>
          <udp-bypass-exceed-queue>no</udp-bypass-exceed-queue>
        </ctd>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_high_dp_load
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <enable-log-high-dp-load>yes</enable-log-high-dp-load>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_max_csv
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <max-rows-in-csv-export>1048576</max-rows-in-csv-export>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_api_key_lifetime
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <api>
            <key>
              <lifetime>{{ API_KEY_LIFETIME }}</lifetime>
            </key>
          </api>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_admin_lockout
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <admin-lockout>
            <failed-attempts>5</failed-attempts>
            <lockout-time>30</lockout-time>
          </admin-lockout>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_idle_timeout
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <idle-timeout>10</idle-timeout>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_commit_lock
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <management>
          <auto-acquire-commit-lock>yes</auto-acquire-commit-lock>
        </management>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_wildfire
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <wildfire>
           <file-size-limit>
            <entry name="pe">
              <size-limit>16</size-limit>
            </entry>
            <entry name="apk">
              <size-limit>30</size-limit>
            </entry>
            <entry name="pdf">
              <size-limit>3072</size-limit>
            </entry>
            <entry name="ms-office">
              <size-limit>16384</size-limit>
            </entry>
            <entry name="jar">
              <size-limit>5</size-limit>
            </entry>
            <entry name="flash">
              <size-limit>5</size-limit>
            </entry>
            <entry name="MacOSX">
              <size-limit>10</size-limit>
            </entry>
            <entry name="archive">
              <size-limit>50</size-limit>
            </entry>
            <entry name="linux">
              <size-limit>50</size-limit>
            </entry>
            <entry name="script">
              <size-limit>2000</size-limit>
            </entry>
           </file-size-limit>
          <report-benign-file>yes</report-benign-file>
          <report-grayware-file>yes</report-grayware-file>
        </wildfire>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_config
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <config>
          <rematch>yes</rematch>
        </config>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_application
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <application>
          <notify-user>yes</notify-user>
          <bypass-exceed-queue>no</bypass-exceed-queue>
        </application>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_logging
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <logging>
          <log-suppression>no</log-suppression>
        </logging>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_tcp
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <tcp>
          <urgent-data>clear</urgent-data>
          <drop-zero-flag>yes</drop-zero-flag>
          <bypass-exceed-oo-queue>no</bypass-exceed-oo-queue>
          <check-timestamp-option>yes</check-timestamp-option>
          <strip-mptcp-option>yes</strip-mptcp-option>
        </tcp>
    cmd: set

-   name: panorama_device_setting_10_0.ironskillet_device_setting_packet_buffer
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/deviceconfig/setting
    element: |-
        <session>
          <packet-buffer-protection-enable>yes</packet-buffer-protection-enable>
        </session>
    cmd: set

-   name: panorama_device_mgt_config_10_0.ironskillet_device_mgt_users
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/mgt-config
    element: |-
        <users>
          <entry name="{{ ADMINISTRATOR_USERNAME }}">
            <phash>{{ ADMINISTRATOR_PASSWORD | md5_hash }}</phash>
            <permissions>
              <role-based>
                <superuser>yes</superuser>
              </role-based>
            </permissions>
          </entry>
        </users>
    cmd: set

-   name: panorama_device_mgt_config_10_0.ironskillet_device_mgt_password_complexity
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/mgt-config
    element: |-
        <password-complexity>
          <enabled>yes</enabled>
          <minimum-length>12</minimum-length>
          <minimum-uppercase-letters>1</minimum-uppercase-letters>
          <minimum-lowercase-letters>1</minimum-lowercase-letters>
          <minimum-numeric-letters>1</minimum-numeric-letters>
          <minimum-special-characters>1</minimum-special-characters>
          <block-username-inclusion>yes</block-username-inclusion>
          <password-history-count>24</password-history-count>
          <new-password-differs-by-characters>3</new-password-differs-by-characters>
        </password-complexity>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_email_profile
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <email>
          <entry name="Sample_Email_Profile">
            <server>
              <entry name="Sample_Email_Profile">
                <display-name>Threat_Alerts</display-name>
                <gateway>{{ EMAIL_PROFILE_GATEWAY }}</gateway>
                <from>{{ EMAIL_PROFILE_FROM }}</from>
                <to>{{ EMAIL_PROFILE_TO }}</to>
                <protocol>SMTP</protocol>
              </entry>
            </server>
          </entry>
        </email>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_syslog_profile
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <syslog>
          <entry name="Sample_Syslog_Profile">
            <server>
              <entry name="Sample_Syslog">
                <transport>UDP</transport>
                <port>514</port>
                <format>BSD</format>
                <server>{{ SYSLOG_SERVER }}</server>
                <facility>LOG_USER</facility>
              </entry>
            </server>
          </entry>
        </syslog>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_syslog_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <system>
          <match-list>
            <entry name="System_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </system>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_log_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <config>
          <match-list>
            <entry name="Configuration_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </config>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_userid_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <userid>
          <match-list>
            <entry name="User-ID_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </userid>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_hip_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <hipmatch>
          <match-list>
            <entry name="HIP_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </hipmatch>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_correlation_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <correlation>
          <match-list>
            <entry name="Correlation_Log_Forwarding">
              <send-syslog>
                <member>Sample_Syslog_Profile</member>
              </send-syslog>
              <filter>All Logs</filter>
            </entry>
          </match-list>
        </correlation>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_gp_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <globalprotect>
          <match-list>
            <entry name="GP_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </globalprotect>
    cmd: set

-   name: panorama_shared_log_settings_10_0.ironskillet_shared_log_settings_ip_tag_forwarding
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/shared/log-settings
    element: |-
        <iptag>
          <match-list>
            <entry name="IP_Tag_Log_Forwarding">
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </iptag>
    cmd: set

-   name: panorama_zone_protection_profile_10_0.ironskillet_zone_protection
    xpath: /config/devices/entry[@name='localhost.localdomain']/template-stack/entry[@name='{{STACK}}']/config/devices/entry[@name='localhost.localdomain']/network/profiles/zone-protection-profile
    element: |-
        <entry name="Recommended_Zone_Protection">
          <flood>
            <tcp-syn>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </tcp-syn>
            <icmp>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </icmp>
            <icmpv6>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </icmpv6>
            <other-ip>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </other-ip>
            <udp>
              <red>
                <alarm-rate>10000</alarm-rate>
                <activate-rate>10000</activate-rate>
                <maximal-rate>40000</maximal-rate>
              </red>
              <enable>no</enable>
            </udp>
          </flood>
          <scan>
            <entry name="8001">
              <action>
                <alert/>
              </action>
              <interval>2</interval>
              <threshold>100</threshold>
            </entry>
            <entry name="8002">
              <action>
                <alert/>
              </action>
              <interval>10</interval>
              <threshold>100</threshold>
            </entry>
            <entry name="8003">
              <action>
                <alert/>
              </action>
              <interval>2</interval>
              <threshold>100</threshold>
            </entry>
          </scan>
          <discard-ip-spoof>yes</discard-ip-spoof>
          <discard-malformed-option>yes</discard-malformed-option>
          <remove-tcp-timestamp>yes</remove-tcp-timestamp>
          <strip-tcp-fast-open-and-data>no</strip-tcp-fast-open-and-data>
          <strip-mptcp-option>global</strip-mptcp-option>
        </entry>
    cmd: set

-   name: panorama_device_group_10_0.ironskillet_device_setting_ctd
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group
    element: |-
        <entry name="{{ DEVICE_GROUP }}">
         <devices></devices>
        </entry>
    cmd: set

-   name: panorama_tag_10_0.ironskillet_tag_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/tag
    element: |-
        <entry name="Outbound">
            <comments>Outbound to the Internet</comments>
        </entry>
    cmd: set

-   name: panorama_tag_10_0.ironskillet_tag_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/tag
    element: |-
        <entry name="Inbound">
            <comments>Inbound from the Internet</comments>
        </entry>
    cmd: set

-   name: panorama_tag_10_0.ironskillet_tag_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/tag
    element: |-
        <entry name="Internal">
            <comments>Internal to Internal</comments>
        </entry>
    cmd: set

-   name: panorama_tag_10_0.ironskillet_tag_ironskillet_version
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/tag
    element: |-
        <entry name="iron-skillet-version">
            <comments>version 0.0.3 for 10.0 - version of this IronSkillet template file</comments>
        </entry>
    cmd: set

-   name: panorama_log_settings_profiles_10_0.ironskillet_log_settings_profiles
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/log-settings/profiles
    element: |-
        <entry name="default">
          <match-list>
            <entry name="Traffic_Log_Forwarding">
              <log-type>traffic</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="Threat_Log_Forwarding">
              <log-type>threat</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="Wildfire_Log_Forwarding">
              <log-type>wildfire</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="URL_Log_Forwarding">
              <log-type>url</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="Data_Log_Forwarding">
              <log-type>data</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="Tunnel_Log_Forwarding">
              <log-type>tunnel</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
            <entry name="Auth_Log_Forwarding">
              <log-type>auth</log-type>
              <filter>All Logs</filter>
              <send-to-panorama>yes</send-to-panorama>
            </entry>
          </match-list>
        </entry>
    cmd: set

-   name: panorama_profiles_custom_url_category_10_0.ironskillet_custom_url_category_block
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/custom-url-category
    element: |-
        <entry name="Block">
          <type>URL List</type>
        </entry>
    cmd: set

-   name: panorama_profiles_custom_url_category_10_0.ironskillet_custom_url_category_allow
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/custom-url-category
    element: |-
        <entry name="Allow">
          <type>URL List</type>
        </entry>
    cmd: set

-   name: panorama_profiles_custom_url_category_10_0.ironskillet_custom_url_category_no_decrypt
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/custom-url-category
    element: |-
        <entry name="Custom-No-Decrypt">
          <type>URL List</type>
        </entry>
    cmd: set

-   name: panorama_profiles_decryption_10_0.ironskillet_decryption_profile
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/decryption
    element: |-
        <entry name="Recommended_Decryption_Profile">
          <ssl-forward-proxy>
            <block-expired-certificate>yes</block-expired-certificate>
            <block-untrusted-issuer>yes</block-untrusted-issuer>
            <block-unknown-cert>yes</block-unknown-cert>
            <block-timeout-cert>yes</block-timeout-cert>
            <block-unsupported-version>yes</block-unsupported-version>
            <block-unsupported-cipher>yes</block-unsupported-cipher>
          </ssl-forward-proxy>
          <ssl-no-proxy>
            <block-expired-certificate>yes</block-expired-certificate>
            <block-untrusted-issuer>yes</block-untrusted-issuer>
          </ssl-no-proxy>
          <ssl-inbound-proxy>
            <block-unsupported-version>no</block-unsupported-version>
            <block-unsupported-cipher>no</block-unsupported-cipher>
          </ssl-inbound-proxy>
          <ssh-proxy>
            <block-unsupported-version>yes</block-unsupported-version>
            <block-unsupported-alg>yes</block-unsupported-alg>
          </ssh-proxy>
          <ssl-protocol-settings>
            <min-version>tls1-2</min-version>
            <max-version>tls1-3</max-version>
            <keyxchg-algo-rsa>no</keyxchg-algo-rsa>
            <enc-algo-3des>no</enc-algo-3des>
            <enc-algo-rc4>no</enc-algo-rc4>
            <auth-algo-sha1>no</auth-algo-sha1>
          </ssl-protocol-settings>
        </entry>
    cmd: set

-   name: panorama_profiles_virus_10_0.ironskillet_antivirus_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/virus
    element: |-
        <entry name="Alert-Only-AV">
          <decoder>
            <entry name="ftp">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="http">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="http2">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="imap">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="pop3">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="smb">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
            <entry name="smtp">
              <action>alert</action>
              <wildfire-action>alert</wildfire-action>
              <mlav-action>alert</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
            <entry name="Executable Linked Format">
              <mlav-policy-action>enable(alert-only)</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_virus_10_0.ironskillet_antivirus_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/virus
    element: |-
        <entry name="Outbound-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="Executable Linked Format">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_virus_10_0.ironskillet_antivirus_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/virus
    element: |-
        <entry name="Inbound-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="Executable Linked Format">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_virus_10_0.ironskillet_antivirus_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/virus
    element: |-
        <entry name="Internal-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="Executable Linked Format">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_virus_10_0.ironskillet_antivirus_exception
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/virus
    element: |-
        <entry name="Exception-AV">
          <decoder>
            <entry name="ftp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="http2">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="imap">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="pop3">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smb">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
            <entry name="smtp">
              <action>reset-both</action>
              <wildfire-action>reset-both</wildfire-action>
              <mlav-action>reset-both</mlav-action>
            </entry>
          </decoder>
          <mlav-engine-filebased-enabled>
            <entry name="Windows Executables">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 1">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="PowerShell Script 2">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
            <entry name="Executable Linked Format">
              <mlav-policy-action>enable</mlav-policy-action>
            </entry>
          </mlav-engine-filebased-enabled>
          <description>Use this profile for rules needing modifications to the standard</description>
        </entry>
    cmd: set

-   name: panorama_profiles_spyware_10_0.ironskillet_spyware_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/spyware
    element: |-
        <entry name="Outbound-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_spyware_10_0.ironskillet_spyware_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/spyware
    element: |-
        <entry name="Inbound-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_spyware_10_0.ironskillet_spyware_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/spyware
    element: |-
        <entry name="Internal-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <sinkhole/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>sinkhole</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Block-Critical-High">
              <action>
                <reset-both/>
              </action>
              <severity>
                <member>critical</member>
                <member>high</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Medium-Low-Info">
              <action>
                <default/>
              </action>
              <severity>
                <member>medium</member>
                <member>low</member>
                <member>informational</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_spyware_10_0.ironskillet_spyware_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/spyware
    element: |-
        <entry name="Alert-Only-AS">
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <action>
                  <alert/>
                </action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>allow</action>
                <packet-capture>single-packet</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
          <rules>
            <entry name="Alert-All">
              <action>
                <alert/>
              </action>
              <severity>
                <member>any</member>
              </severity>
              <threat-name>any</threat-name>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_spyware_10_0.ironskillet_spyware_exception
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/spyware
    element: |-
        <entry name="Exception-AS">
          <description>Used for exception cases not part of the recommended practice</description>
          <botnet-domains>
            <lists>
              <entry name="default-paloalto-dns">
                <packet-capture>disable</packet-capture>
                <action>
                  <sinkhole/>
                </action>
              </entry>
            </lists>
            <dns-security-categories>
              <entry name="pan-dns-sec-benign">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-cc">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-ddns">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-malware">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
              <entry name="pan-dns-sec-recent">
                <log-level>default</log-level>
                <action>default</action>
                <packet-capture>disable</packet-capture>
              </entry>
            </dns-security-categories>
            <sinkhole>
              <ipv4-address>{{ SINKHOLE_IPV4 }}</ipv4-address>
              <ipv6-address>{{ SINKHOLE_IPV6 }}</ipv6-address>
            </sinkhole>
          </botnet-domains>
        </entry>
    cmd: set

-   name: panorama_profiles_vulnerability_10_0.ironskillet_vulnerability_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/vulnerability
    element: |-
        <entry name="Outbound-VP">
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_vulnerability_10_0.ironskillet_vulnerability_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/vulnerability
    element: |-
        <entry name="Inbound-VP">
          <rules>
            <entry name="Block-Critical-High-Medium">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_vulnerability_10_0.ironskillet_vulnerability_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/vulnerability
    element: |-
        <entry name="Internal-VP">
          <rules>
            <entry name="Block-Critical-High">
              <action>
                <reset-both/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>critical</member>
                <member>high</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>single-packet</packet-capture>
            </entry>
            <entry name="Default-Medium-Low-Info">
              <action>
                <default/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>low</member>
                <member>informational</member>
                <member>medium</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_vulnerability_10_0.ironskillet_vulnerability_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/vulnerability
    element: |-
        <entry name="Alert-Only-VP">
          <rules>
            <entry name="Alert-All">
              <action>
                <alert/>
              </action>
              <vendor-id>
                <member>any</member>
              </vendor-id>
              <severity>
                <member>any</member>
              </severity>
              <cve>
                <member>any</member>
              </cve>
              <threat-name>any</threat-name>
              <host>any</host>
              <category>any</category>
              <packet-capture>disable</packet-capture>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_vulnerability_10_0.ironskillet_vulnerability_exception
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/vulnerability
    element: |-
        <entry name="Exception-VP">
          <rules/>
        </entry>
    cmd: set

-   name: panorama_profiles_file_blocking_10_0.ironskillet_file_blocking_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/file-blocking
    element: |-
        <entry name="Outbound-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>dll</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_file_blocking_10_0.ironskillet_file_blocking_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/file-blocking
    element: |-
        <entry name="Inbound-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>dll</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_file_blocking_10_0.ironskillet_file_blocking_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/file-blocking
    element: |-
        <entry name="Internal-FB">
          <rules>
            <entry name="Alert-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
            <entry name="Block">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>7z</member>
                <member>bat</member>
                <member>chm</member>
                <member>class</member>
                <member>cpl</member>
                <member>hlp</member>
                <member>hta</member>
                <member>jar</member>
                <member>ocx</member>
                <member>pif</member>
                <member>scr</member>
                <member>torrent</member>
                <member>vbe</member>
                <member>wsf</member>
              </file-type>
              <direction>both</direction>
              <action>block</action>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_file_blocking_10_0.ironskillet_file_blocking_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/file-blocking
    element: |-
        <entry name="Alert-Only-FB">
          <rules>
            <entry name="Alert-Only">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <action>alert</action>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_url_filtering_10_0.ironskillet_url_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/url-filtering
    element: |-
        <entry name="Outbound-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>high</log-severity>
            <block>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>real-time-detection</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </block>
          </credential-enforcement>
          <log-http-hdr-user-agent>yes</log-http-hdr-user-agent>
          <log-http-hdr-referer>yes</log-http-hdr-referer>
          <log-http-hdr-xff>yes</log-http-hdr-xff>
          <alert>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>real-time-detection</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <block>
            <member>Block</member>
            <member>command-and-control</member>
            <member>grayware</member>
            <member>malware</member>
            <member>phishing</member>
          </block>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_url_filtering_10_0.ironskillet_url_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/url-filtering
    element: |-
        <entry name="Alert-Only-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>medium</log-severity>
            <alert>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>real-time-detection</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </alert>
          </credential-enforcement>
          <alert>
            <member>Block</member>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>command-and-control</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>grayware</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>malware</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>phishing</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>real-time-detection</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>alert</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>alert</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_url_filtering_10_0.ironskillet_url_exception
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/url-filtering
    element: |-
        <entry name="Exception-URL">
          <credential-enforcement>
            <mode>
              <ip-user/>
            </mode>
            <log-severity>high</log-severity>
            <block>
              <member>Block</member>
              <member>Allow</member>
              <member>abortion</member>
              <member>abused-drugs</member>
              <member>adult</member>
              <member>alcohol-and-tobacco</member>
              <member>auctions</member>
              <member>business-and-economy</member>
              <member>command-and-control</member>
              <member>computer-and-internet-info</member>
              <member>content-delivery-networks</member>
              <member>copyright-infringement</member>
              <member>cryptocurrency</member>
              <member>dating</member>
              <member>dynamic-dns</member>
              <member>educational-institutions</member>
              <member>entertainment-and-arts</member>
              <member>extremism</member>
              <member>financial-services</member>
              <member>gambling</member>
              <member>games</member>
              <member>government</member>
              <member>grayware</member>
              <member>hacking</member>
              <member>health-and-medicine</member>
              <member>high-risk</member>
              <member>home-and-garden</member>
              <member>hunting-and-fishing</member>
              <member>insufficient-content</member>
              <member>internet-communications-and-telephony</member>
              <member>internet-portals</member>
              <member>job-search</member>
              <member>legal</member>
              <member>low-risk</member>
              <member>malware</member>
              <member>medium-risk</member>
              <member>military</member>
              <member>motor-vehicles</member>
              <member>music</member>
              <member>newly-registered-domain</member>
              <member>news</member>
              <member>not-resolved</member>
              <member>nudity</member>
              <member>online-storage-and-backup</member>
              <member>parked</member>
              <member>peer-to-peer</member>
              <member>personal-sites-and-blogs</member>
              <member>philosophy-and-political-advocacy</member>
              <member>phishing</member>
              <member>private-ip-addresses</member>
              <member>proxy-avoidance-and-anonymizers</member>
              <member>questionable</member>
              <member>real-estate</member>
              <member>real-time-detection</member>
              <member>recreation-and-hobbies</member>
              <member>reference-and-research</member>
              <member>religion</member>
              <member>search-engines</member>
              <member>sex-education</member>
              <member>shareware-and-freeware</member>
              <member>shopping</member>
              <member>social-networking</member>
              <member>society</member>
              <member>sports</member>
              <member>stock-advice-and-tools</member>
              <member>streaming-media</member>
              <member>swimsuits-and-intimate-apparel</member>
              <member>training-and-tools</member>
              <member>translation</member>
              <member>travel</member>
              <member>unknown</member>
              <member>weapons</member>
              <member>web-advertisements</member>
              <member>web-based-email</member>
              <member>web-hosting</member>
            </block>
          </credential-enforcement>
          <log-http-hdr-user-agent>yes</log-http-hdr-user-agent>
          <log-http-hdr-referer>yes</log-http-hdr-referer>
          <log-http-hdr-xff>yes</log-http-hdr-xff>
          <alert>
            <member>Allow</member>
            <member>abortion</member>
            <member>abused-drugs</member>
            <member>adult</member>
            <member>alcohol-and-tobacco</member>
            <member>auctions</member>
            <member>business-and-economy</member>
            <member>computer-and-internet-info</member>
            <member>content-delivery-networks</member>
            <member>copyright-infringement</member>
            <member>cryptocurrency</member>
            <member>dating</member>
            <member>dynamic-dns</member>
            <member>educational-institutions</member>
            <member>entertainment-and-arts</member>
            <member>extremism</member>
            <member>financial-services</member>
            <member>gambling</member>
            <member>games</member>
            <member>government</member>
            <member>hacking</member>
            <member>health-and-medicine</member>
            <member>high-risk</member>
            <member>home-and-garden</member>
            <member>hunting-and-fishing</member>
            <member>insufficient-content</member>
            <member>internet-communications-and-telephony</member>
            <member>internet-portals</member>
            <member>job-search</member>
            <member>legal</member>
            <member>low-risk</member>
            <member>medium-risk</member>
            <member>military</member>
            <member>motor-vehicles</member>
            <member>music</member>
            <member>newly-registered-domain</member>
            <member>news</member>
            <member>not-resolved</member>
            <member>nudity</member>
            <member>online-storage-and-backup</member>
            <member>parked</member>
            <member>peer-to-peer</member>
            <member>personal-sites-and-blogs</member>
            <member>philosophy-and-political-advocacy</member>
            <member>private-ip-addresses</member>
            <member>proxy-avoidance-and-anonymizers</member>
            <member>questionable</member>
            <member>real-estate</member>
            <member>real-time-detection</member>
            <member>recreation-and-hobbies</member>
            <member>reference-and-research</member>
            <member>religion</member>
            <member>search-engines</member>
            <member>sex-education</member>
            <member>shareware-and-freeware</member>
            <member>shopping</member>
            <member>social-networking</member>
            <member>society</member>
            <member>sports</member>
            <member>stock-advice-and-tools</member>
            <member>streaming-media</member>
            <member>swimsuits-and-intimate-apparel</member>
            <member>training-and-tools</member>
            <member>translation</member>
            <member>travel</member>
            <member>unknown</member>
            <member>weapons</member>
            <member>web-advertisements</member>
            <member>web-based-email</member>
            <member>web-hosting</member>
          </alert>
          <block>
            <member>Block</member>
            <member>command-and-control</member>
            <member>grayware</member>
            <member>malware</member>
            <member>phishing</member>
          </block>
          <mlav-engine-urlbased-enabled>
            <entry name="Phishing Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
            <entry name="Javascript Exploit Detection">
              <mlav-policy-action>block</mlav-policy-action>
            </entry>
          </mlav-engine-urlbased-enabled>
        </entry>
    cmd: set

-   name: panorama_profiles_wildfire_analysis_10_0.ironskillet_wildfire_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/wildfire-analysis
    element: |-
        <entry name="Outbound-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_wildfire_analysis_10_0.ironskillet_wildfire_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/wildfire-analysis
    element: |-
        <entry name="Inbound-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_wildfire_analysis_10_0.ironskillet_wildfire_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/wildfire-analysis
    element: |-
        <entry name="Internal-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profiles_wildfire_analysis_10_0.ironskillet_wildfire_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profiles/wildfire-analysis
    element: |-
        <entry name="Alert-Only-WF">
          <rules>
            <entry name="Forward-All">
              <application>
                <member>any</member>
              </application>
              <file-type>
                <member>any</member>
              </file-type>
              <direction>both</direction>
              <analysis>public-cloud</analysis>
            </entry>
          </rules>
        </entry>
    cmd: set

-   name: panorama_profile_group_10_0.ironskillet_profile_group_outbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profile-group
    element: |-
        <entry name="Outbound">
          <virus>
            <member>Outbound-AV</member>
          </virus>
          <spyware>
            <member>Outbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Outbound-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Outbound-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Outbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Outbound-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set

-   name: panorama_profile_group_10_0.ironskillet_profile_group_inbound
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profile-group
    element: |-
        <entry name="Inbound">
          <virus>
            <member>Inbound-AV</member>
          </virus>
          <spyware>
            <member>Inbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Inbound-VP</member>
          </vulnerability>
          <file-blocking>
            <member>Inbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Inbound-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set

-   name: panorama_profile_group_10_0.ironskillet_profile_group_internal
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profile-group
    element: |-
        <entry name="Internal">
          <virus>
            <member>Internal-AV</member>
          </virus>
          <spyware>
            <member>Internal-AS</member>
          </spyware>
          <vulnerability>
            <member>Internal-VP</member>
          </vulnerability>
          <file-blocking>
            <member>Internal-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Internal-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set

-   name: panorama_profile_group_10_0.ironskillet_profile_group_alert_all
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profile-group
    element: |-
        <entry name="Alert-Only">
          <virus>
            <member>Alert-Only-AV</member>
          </virus>
          <spyware>
            <member>Alert-Only-AS</member>
          </spyware>
          <vulnerability>
            <member>Alert-Only-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Alert-Only-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Alert-Only-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Alert-Only-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set

-   name: panorama_profile_group_10_0.ironskillet_profile_group_default
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/profile-group
    element: |-
        <entry name="default">
          <virus>
            <member>Outbound-AV</member>
          </virus>
          <spyware>
            <member>Outbound-AS</member>
          </spyware>
          <vulnerability>
            <member>Outbound-VP</member>
          </vulnerability>
          <url-filtering>
            <member>Outbound-URL</member>
          </url-filtering>
          <file-blocking>
            <member>Outbound-FB</member>
          </file-blocking>
          <wildfire-analysis>
            <member>Outbound-WF</member>
          </wildfire-analysis>
        </entry>
    cmd: set

-   name: panorama_post_rulebase_default_security_rules_10_0.ironskillet_post_rulebase_default_security_rules
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/post-rulebase/default-security-rules
    element: |-
        <rules>
          <entry name="intrazone-default">
            <action>allow</action>
            <log-start>no</log-start>
            <log-end>yes</log-end>
            <profile-setting>
              <group>
                <member>Inbound</member>
              </group>
            </profile-setting>
            <log-setting>default</log-setting>
          </entry>
          <entry name="interzone-default">
            <action>drop</action>
            <log-start>no</log-start>
            <log-end>yes</log-end>
            <log-setting>default</log-setting>
          </entry>
        </rules>
    cmd: set

-   name: panorama_pre_rulebase_security_10_0.ironskillet_pre_rulebase_security
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/pre-rulebase
    element: |-
        <security>
          {%- if INCLUDE_PAN_EDL == 'no' %}
          <rules/>
          {%- elif INCLUDE_PAN_EDL == 'yes' %}
          <rules>
            <entry name="Outbound Block Rule">
              <description>Block outbound sessions with destination address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses.</description>
              <to>
                <member>any</member>
              </to>
              <from>
                <member>any</member>
              </from>
              <source>
                <member>any</member>
              </source>
              <destination>
                <member>panw-highrisk-ip-list</member>
                <member>panw-known-ip-list</member>
                <member>panw-bulletproof-ip-list</member>
              </destination>
              <source-user>
                <member>any</member>
              </source-user>
              <category>
                <member>any</member>
              </category>
              <application>
                <member>any</member>
              </application>
              <service>
                <member>any</member>
              </service>
              <hip-profiles>
                <member>any</member>
              </hip-profiles>
              <action>deny</action>
              <log-setting>default</log-setting>
              <tag>
                <member>Outbound</member>
              </tag>
            </entry>
            <entry name="Inbound Block Rule">
              <description>Block inbound sessions with source address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses.</description>
              <to>
                <member>any</member>
              </to>
              <from>
                <member>any</member>
              </from>
              <source>
                <member>panw-highrisk-ip-list</member>
                <member>panw-known-ip-list</member>
                <member>panw-bulletproof-ip-list</member>
              </source>
              <destination>
                <member>any</member>
              </destination>
              <source-user>
                <member>any</member>
              </source-user>
              <category>
                <member>any</member>
              </category>
              <application>
                <member>any</member>
              </application>
              <service>
                <member>any</member>
              </service>
              <hip-profiles>
                <member>any</member>
              </hip-profiles>
              <action>deny</action>
              <log-setting>default</log-setting>
              <tag>
                <member>Inbound</member>
              </tag>
            </entry>
          </rules>
          {%- endif %}
        </security>
    cmd: set

-   name: panorama_pre_rulebase_decryption_10_0.ironskillet_pre_rulebase_decryption
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{DEVICE_GROUP}}']/pre-rulebase/decryption
    element: |-
        <rules>
          <entry name="NO-Decrypt URL Categories">
            <target>
              <negate>no</negate>
            </target>
            <category>
              <member>financial-services</member>
              <member>government</member>
              <member>health-and-medicine</member>
              <member>Custom-No-Decrypt</member>
            </category>
            <service>
              <member>any</member>
            </service>
            <type>
              <ssl-forward-proxy/>
            </type>
            <from>
              <member>any</member>
            </from>
            <to>
              <member>any</member>
            </to>
            <source>
              <member>any</member>
            </source>
            <destination>
              <member>any</member>
            </destination>
            <source-user>
              <member>any</member>
            </source-user>
            <profile>Recommended_Decryption_Profile</profile>
            <action>no-decrypt</action>
            <disabled>yes</disabled>
            <description>This rule does not do Decryption.  This rule is validating SSL Protocol Communications.</description>
          </entry>
        </rules>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_host_visit_malicious_plus
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Host-visit malicious sites plus">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Host-visit malicious sites plus</caption>
          <frequency>daily</frequency>
          <query>(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)</query>
          <type>
            <panorama-url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
                <member>category</member>
                <member>action</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-url>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_host_visit_malicious
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Hosts visit malicious sites">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Hosts visit malicious sites</caption>
          <frequency>daily</frequency>
          <query>(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)</query>
          <type>
            <panorama-url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-url>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_host_visit_questionable
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Hosts visit questionable sites">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Hosts visit questionable sites</caption>
          <frequency>daily</frequency>
          <query>(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)</query>
          <type>
            <panorama-url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-url>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_host_visit_questionable_plus
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Host-visit quest sites plus">
          <period>last-7-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Host-visit quest sites plus</caption>
          <frequency>daily</frequency>
          <query>(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)</query>
          <description>Detail of hosts visiting questionable URLs</description>
          <type>
            <panorama-url>
              <sortby>repeatcnt</sortby>
              <group-by>src</group-by>
              <aggregate-by>
                <member>from</member>
                <member>srcuser</member>
                <member>category</member>
                <member>action</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-url>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_wildfire_malicious_verdicts
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Wildfire malicious verdicts">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>10</topm>
          <caption>Wildfire malicious verdicts</caption>
          <frequency>daily</frequency>
          <query>(app neq smtp) and (category neq benign)</query>
          <description>Files uploaded or downloaded that were later found to be malicious. This is a summary. Act on real-time email.</description>
          <type>
            <panorama-wildfire>
              <sortby>repeatcnt</sortby>
              <aggregate-by>
                <member>filedigest</member>
                <member>container-of-app</member>
                <member>app</member>
                <member>category</member>
                <member>filetype</member>
                <member>rule</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-wildfire>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_wildfire_verdicts_smtp
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Wildfire verdicts SMTP">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>10</topm>
          <caption>Wildfire verdicts SMTP</caption>
          <frequency>daily</frequency>
          <query>(app eq smtp) and (category neq benign)</query>
          <description>Links sent from emails found to be malicious. </description>
          <type>
            <panorama-wildfire>
              <sortby>repeatcnt</sortby>
              <aggregate-by>
                <member>filedigest</member>
                <member>container-of-app</member>
                <member>app</member>
                <member>category</member>
                <member>filetype</member>
                <member>rule</member>
                <member>subject</member>
                <member>sender</member>
                <member>recipient</member>
                <member>misc</member>
              </aggregate-by>
            </panorama-wildfire>
          </type>
        </entry>
    cmd: set

-   name: panorama_reports_simple_10_0.ironskillet_reports_clients_sinkholed
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/reports
    element: |-
        <entry name="Clients sinkholed">
          <period>last-30-calendar-days</period>
          <topn>500</topn>
          <topm>50</topm>
          <caption>Clients sinkholed</caption>
          <query>(rule eq 'DNS Sinkhole Block')</query>
          <frequency>daily</frequency>
          <type>
            <panorama-traffic>
              <sortby>repeatcnt</sortby>
              <group-by>from</group-by>
              <aggregate-by>
                <member>src</member>
                <member>srcuser</member>
              </aggregate-by>
              <values>
                <member>repeatcnt</member>
              </values>
            </panorama-traffic>
          </type>
        </entry>
    cmd: set

-   name: panorama_report_group_simple_10_0.ironskillet_report_group_simple
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/report-group
    element: |-
        <entry name="Possible Compromise">
          <custom-widget>
            <entry name="1">
              <custom-report>Clients sinkholed</custom-report>
            </entry>
            <entry name="2">
              <custom-report>Wildfire malicious verdicts</custom-report>
            </entry>
            <entry name="3">
              <custom-report>Wildfire verdicts SMTP</custom-report>
            </entry>
            <entry name="4">
              <custom-report>Hosts visit malicious sites</custom-report>
            </entry>
            <entry name="5">
              <custom-report>Host-visit malicious sites plus</custom-report>
            </entry>
            <entry name="6">
              <custom-report>Hosts visit questionable sites</custom-report>
            </entry>
            <entry name="7">
              <custom-report>Host-visit quest sites plus</custom-report>
            </entry>
          </custom-widget>
          <title-page>yes</title-page>
          <variable>
            <entry name="title">
              <value>Possible Compromise</value>
            </entry>
          </variable>
        </entry>
    cmd: set

-   name: panorama_email_scheduler_simple_10_0.ironskillet_email_scheduler
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{
        DEVICE_GROUP }}']/email-scheduler
    element: |-
        <entry name="Possible Compromise">
          <report-group>Possible Compromise</report-group>
          <recurring>
            <disabled/>
          </recurring>
          <email-profile>Sample_Email_Profile</email-profile>
        </entry>
    cmd: set

