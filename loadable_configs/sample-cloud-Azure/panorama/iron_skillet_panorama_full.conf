# set command configuration for Panorama version 9.0
# commands are expected to be load in order
# this template uses jinja format
# either 'search and replace' or the scripts in the tools dir can be used to create a loadable configuration

# management interface configuration - may be skipped if already online
set deviceconfig system hostname panorama01
set deviceconfig system ip-address 192.168.55.161
set deviceconfig system netmask 255.255.255.0
set deviceconfig system default-gateway 192.168.55.2
set deviceconfig system dns-setting servers primary 8.8.8.8
set deviceconfig system dns-setting servers secondary 8.8.4.4
set deviceconfig system ntp-servers primary-ntp-server ntp-server-address 0.pool.ntp.org
set deviceconfig system ntp-servers secondary-ntp-server ntp-server-address 1.pool.ntp.org

# remove admin/admin default and add user defined super user
set mgt-config users admin password
set mgt-config users admin permissions role-based superuser yes
# recommended to delete the admin user with another superuser username
delete mgt-config users admin

# add password complexity profile - will not effect existing passwords
set mgt-config password-complexity enabled yes
set mgt-config password-complexity minimum-length 12
set mgt-config password-complexity minimum-uppercase-letters 1
set mgt-config password-complexity minimum-lowercase-letters 1
set mgt-config password-complexity minimum-numeric-letters 1
set mgt-config password-complexity minimum-special-characters 1
set mgt-config password-complexity block-username-inclusion yes
set mgt-config password-complexity password-history-count 24
set mgt-config password-complexity new-password-differs-by-characters 3
set mgt-config password-complexity password-change expiration-period 90

# additional base Panorama system configuration
set deviceconfig system update-server updates.paloaltonetworks.com
set deviceconfig system update-schedule threats recurring every-30-mins at 2
set deviceconfig system update-schedule threats recurring every-30-mins action download-and-install
set deviceconfig system update-schedule threats recurring threshold 48
set deviceconfig system update-schedule anti-virus recurring hourly at 4
set deviceconfig system update-schedule anti-virus recurring hourly action download-and-install
set deviceconfig system update-schedule wildfire recurring every-min action download-and-install
set deviceconfig system timezone UTC
set deviceconfig system service disable-telnet yes
set deviceconfig system service disable-http yes
set deviceconfig system server-verification yes
set deviceconfig system login-banner "You have accessed a protected system.Log off immediately if you are not an authorized user."
set deviceconfig system snmp-setting access-setting version v3
set deviceconfig system config-bundle-export-schedule Recommended_Config_Export protocol scp hostname 192.0.2.3
set deviceconfig system config-bundle-export-schedule Recommended_Config_Export protocol scp username testuser
set deviceconfig system config-bundle-export-schedule Recommended_Config_Export protocol scp password -AQ==zPJb3ngM1sGjXlfX2+Qk6rbdv1I=ucInIpBmFcnkQK7zF4VO1w==
set deviceconfig system config-bundle-export-schedule Recommended_Config_Export start-time 02:00
set deviceconfig system config-bundle-export-schedule Recommended_Config_Export enable yes
set deviceconfig setting management storage-partition internal
set deviceconfig setting management hostname-type-in-syslog FQDN
set deviceconfig setting management enable-reporting-on-groups yes
set deviceconfig setting management share-unused-objects-with-devices no
set deviceconfig setting management api key lifetime 525600
set deviceconfig setting management max-rows-in-csv-export 1048576
set deviceconfig setting management admin-lockout failed-attempts 5
set deviceconfig setting management admin-lockout lockout-time 30
set deviceconfig setting management idle-timeout 10
set deviceconfig setting management auto-acquire-commit-lock yes

# Panorama log settings
set panorama log-settings email Sample_Email_Profile server Sample_Email_Profile display-name Panorama
set panorama log-settings email Sample_Email_Profile server Sample_Email_Profile gateway 192.0.2.1
set panorama log-settings email Sample_Email_Profile server Sample_Email_Profile from sentfrom@yourdomain.com
set panorama log-settings email Sample_Email_Profile server Sample_Email_Profile to sendto@yourdomain.com
set panorama log-settings system match-list Critical_System_Log_Email send-email Sample_Email_Profile
set panorama log-settings system match-list Critical_System_Log_Email filter "(severity eq critical)"
set panorama log-settings syslog Sample_Syslog_Profile server Sample_Syslog transport UDP
set panorama log-settings syslog Sample_Syslog_Profile server Sample_Syslog port 514
set panorama log-settings syslog Sample_Syslog_Profile server Sample_Syslog format BSD
set panorama log-settings syslog Sample_Syslog_Profile server Sample_Syslog server 192.0.2.2
set panorama log-settings syslog Sample_Syslog_Profile server Sample_Syslog facility LOG_USER
set panorama log-settings system match-list System_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings system match-list System_Log_Forwarding filter "All Logs"
set panorama log-settings config match-list Configuration_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings config match-list Configuration_Log_Forwarding filter "All Logs"
set panorama log-settings userid match-list User-ID_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings userid match-list User-ID_Log_Forwarding filter "All Logs"
set panorama log-settings threat match-list Threat_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings threat match-list Threat_Log_Forwarding filter "All Logs"
set panorama log-settings data match-list Data_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings data match-list Data_Log_Forwarding filter "All Logs"
set panorama log-settings wildfire match-list WildFire_Malicious send-email Sample_Email_Profile
set panorama log-settings wildfire match-list WildFire_Malicious filter "(verdict eq malicious) or (verdict eq phishing)"
set panorama log-settings wildfire match-list WildFire_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings wildfire match-list WildFire_Log_Forwarding filter "All Logs"
set panorama log-settings tunnel match-list Tunnel_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings tunnel match-list Tunnel_Log_Forwarding filter "All Logs"
set panorama log-settings auth match-list Auth_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings auth match-list Auth_Log_Forwarding filter "All Logs"
set panorama log-settings correlation match-list Correlation_Critical_Email send-email Sample_Email_Profile
set panorama log-settings correlation match-list Correlation_Critical_Email filter "(severity geq medium)"
set panorama log-settings correlation match-list Correlation_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings correlation match-list Correlation_Log_Forwarding filter "All Logs"
set panorama log-settings traffic match-list Traffic_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings traffic match-list Traffic_Log_Forwarding filter "All Logs"
set panorama log-settings hipmatch match-list HIP_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings hipmatch match-list HIP_Log_Forwarding filter "All Logs"
set panorama log-settings url match-list URL_Log_Forwarding send-syslog Sample_Syslog_Profile
set panorama log-settings url match-list URL_Log_Forwarding filter "All Logs"


# shared values used by device-groups and template-stacks

# referenced objects
set shared tag Outbound comments "Outbound to the Internet"
set shared tag Inbound comments "Inbound from the Internet"
set shared tag Internal comments "Internal to Internal"
set shared tag iron-skillet-version comments "version 0.0.3 for 9.0: version of this IronSkillet template file"
set shared address Sinkhole-IPv4 fqdn sinkhole.paloaltonetworks.com
set shared address Sinkhole-IPv6 ip-netmask 2600:5200::1

# shared log settings
set shared log-settings profiles default match-list Traffic_Log_Forwarding log-type traffic
set shared log-settings profiles default match-list Traffic_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Traffic_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Threat_Log_Forwarding log-type threat
set shared log-settings profiles default match-list Threat_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Threat_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Wildfire_Log_Forwarding log-type wildfire
set shared log-settings profiles default match-list Wildfire_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Wildfire_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list URL_Log_Forwarding log-type url
set shared log-settings profiles default match-list URL_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list URL_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Data_Log_Forwarding log-type data
set shared log-settings profiles default match-list Data_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Data_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Tunnel_Log_Forwarding log-type tunnel
set shared log-settings profiles default match-list Tunnel_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Tunnel_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Auth_Log_Forwarding log-type auth
set shared log-settings profiles default match-list Auth_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Auth_Log_Forwarding send-to-panorama yes

# shared decryption profiles
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-expired-certificate yes
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-untrusted-issuer yes
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unknown-cert yes
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-timeout-cert yes
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-version yes
set shared profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-cipher yes
set shared profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-expired-certificate yes
set shared profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-untrusted-issuer yes
set shared profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-version no
set shared profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-cipher no
set shared profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-version yes
set shared profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-alg yes
set shared profiles decryption Recommended_Decryption_Profile ssl-protocol-settings min-version tls1-2
set shared profiles decryption Recommended_Decryption_Profile ssl-protocol-settings keyxchg-algo-rsa no
set shared profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-3des no
set shared profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-rc4 no
set shared profiles decryption Recommended_Decryption_Profile ssl-protocol-settings auth-algo-sha1 no

# shared security profiles
set shared profiles virus Alert-Only-AV decoder ftp action alert
set shared profiles virus Alert-Only-AV decoder ftp wildfire-action alert
set shared profiles virus Alert-Only-AV decoder http action alert
set shared profiles virus Alert-Only-AV decoder http wildfire-action alert
set shared profiles virus Alert-Only-AV decoder http2 action alert
set shared profiles virus Alert-Only-AV decoder http2 wildfire-action alert
set shared profiles virus Alert-Only-AV decoder imap action alert
set shared profiles virus Alert-Only-AV decoder imap wildfire-action alert
set shared profiles virus Alert-Only-AV decoder pop3 action alert
set shared profiles virus Alert-Only-AV decoder pop3 wildfire-action alert
set shared profiles virus Alert-Only-AV decoder smb action alert
set shared profiles virus Alert-Only-AV decoder smb wildfire-action alert
set shared profiles virus Alert-Only-AV decoder smtp action alert
set shared profiles virus Alert-Only-AV decoder smtp wildfire-action alert
set shared profiles virus Outbound-AV decoder ftp action reset-both
set shared profiles virus Outbound-AV decoder ftp wildfire-action reset-both
set shared profiles virus Outbound-AV decoder http action reset-both
set shared profiles virus Outbound-AV decoder http wildfire-action reset-both
set shared profiles virus Outbound-AV decoder http2 action reset-both
set shared profiles virus Outbound-AV decoder http2 wildfire-action reset-both
set shared profiles virus Outbound-AV decoder imap action reset-both
set shared profiles virus Outbound-AV decoder imap wildfire-action reset-both
set shared profiles virus Outbound-AV decoder pop3 action reset-both
set shared profiles virus Outbound-AV decoder pop3 wildfire-action reset-both
set shared profiles virus Outbound-AV decoder smb action reset-both
set shared profiles virus Outbound-AV decoder smb wildfire-action reset-both
set shared profiles virus Outbound-AV decoder smtp action reset-both
set shared profiles virus Outbound-AV decoder smtp wildfire-action reset-both
set shared profiles virus Inbound-AV decoder ftp action reset-both
set shared profiles virus Inbound-AV decoder ftp wildfire-action reset-both
set shared profiles virus Inbound-AV decoder http action reset-both
set shared profiles virus Inbound-AV decoder http wildfire-action reset-both
set shared profiles virus Inbound-AV decoder http2 action reset-both
set shared profiles virus Inbound-AV decoder http2 wildfire-action reset-both
set shared profiles virus Inbound-AV decoder imap action reset-both
set shared profiles virus Inbound-AV decoder imap wildfire-action reset-both
set shared profiles virus Inbound-AV decoder pop3 action reset-both
set shared profiles virus Inbound-AV decoder pop3 wildfire-action reset-both
set shared profiles virus Inbound-AV decoder smb action reset-both
set shared profiles virus Inbound-AV decoder smb wildfire-action reset-both
set shared profiles virus Inbound-AV decoder smtp action reset-both
set shared profiles virus Inbound-AV decoder smtp wildfire-action reset-both
set shared profiles virus Internal-AV decoder ftp action reset-both
set shared profiles virus Internal-AV decoder ftp wildfire-action reset-both
set shared profiles virus Internal-AV decoder http action reset-both
set shared profiles virus Internal-AV decoder http wildfire-action reset-both
set shared profiles virus Internal-AV decoder http2 action reset-both
set shared profiles virus Internal-AV decoder http2 wildfire-action reset-both
set shared profiles virus Internal-AV decoder imap action reset-both
set shared profiles virus Internal-AV decoder imap wildfire-action reset-both
set shared profiles virus Internal-AV decoder pop3 action reset-both
set shared profiles virus Internal-AV decoder pop3 wildfire-action reset-both
set shared profiles virus Internal-AV decoder smb action reset-both
set shared profiles virus Internal-AV decoder smb wildfire-action reset-both
set shared profiles virus Internal-AV decoder smtp action reset-both
set shared profiles virus Internal-AV decoder smtp wildfire-action reset-both
set shared profiles virus Exception-AV decoder ftp action reset-both
set shared profiles virus Exception-AV decoder ftp wildfire-action default
set shared profiles virus Exception-AV decoder http action reset-both
set shared profiles virus Exception-AV decoder http wildfire-action default
set shared profiles virus Exception-AV decoder http2 action reset-both
set shared profiles virus Exception-AV decoder http2 wildfire-action default
set shared profiles virus Exception-AV decoder imap action reset-both
set shared profiles virus Exception-AV decoder imap wildfire-action reset-both
set shared profiles virus Exception-AV decoder pop3 action reset-both
set shared profiles virus Exception-AV decoder pop3 wildfire-action reset-both
set shared profiles virus Exception-AV decoder smb action reset-both
set shared profiles virus Exception-AV decoder smb wildfire-action default
set shared profiles virus Exception-AV decoder smtp action reset-both
set shared profiles virus Exception-AV decoder smtp wildfire-action reset-both
set shared profiles virus Exception-AV description "Use this profile for rules needing modifications to the standard"
set shared profiles spyware Outbound-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set shared profiles spyware Outbound-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set shared profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set shared profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns action sinkhole
set shared profiles spyware Outbound-AS botnet-domains lists default-paloalto-cloud packet-capture single-packet
set shared profiles spyware Outbound-AS botnet-domains lists default-paloalto-cloud action sinkhole
set shared profiles spyware Outbound-AS rules Block-Critical-High-Medium action reset-both
set shared profiles spyware Outbound-AS rules Block-Critical-High-Medium severity [ high critical medium ]
set shared profiles spyware Outbound-AS rules Block-Critical-High-Medium threat-name any
set shared profiles spyware Outbound-AS rules Block-Critical-High-Medium category any
set shared profiles spyware Outbound-AS rules Block-Critical-High-Medium packet-capture single-packet
set shared profiles spyware Outbound-AS rules Default-Low-Info action default
set shared profiles spyware Outbound-AS rules Default-Low-Info severity [ low informational ]
set shared profiles spyware Outbound-AS rules Default-Low-Info threat-name any
set shared profiles spyware Outbound-AS rules Default-Low-Info category any
set shared profiles spyware Outbound-AS rules Default-Low-Info packet-capture disable
set shared profiles spyware Inbound-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set shared profiles spyware Inbound-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set shared profiles spyware Inbound-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set shared profiles spyware Inbound-AS botnet-domains lists default-paloalto-dns action sinkhole
set shared profiles spyware Inbound-AS botnet-domains lists default-paloalto-cloud packet-capture single-packet
set shared profiles spyware Inbound-AS botnet-domains lists default-paloalto-cloud action sinkhole
set shared profiles spyware Inbound-AS rules Block-Critical-High-Medium action reset-both
set shared profiles spyware Inbound-AS rules Block-Critical-High-Medium severity [ high critical medium ]
set shared profiles spyware Inbound-AS rules Block-Critical-High-Medium threat-name any
set shared profiles spyware Inbound-AS rules Block-Critical-High-Medium category any
set shared profiles spyware Inbound-AS rules Block-Critical-High-Medium packet-capture single-packet
set shared profiles spyware Inbound-AS rules Default-Low-Info action default
set shared profiles spyware Inbound-AS rules Default-Low-Info severity [ low informational ]
set shared profiles spyware Inbound-AS rules Default-Low-Info threat-name any
set shared profiles spyware Inbound-AS rules Default-Low-Info category any
set shared profiles spyware Inbound-AS rules Default-Low-Info packet-capture disable
set shared profiles spyware Internal-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set shared profiles spyware Internal-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set shared profiles spyware Internal-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set shared profiles spyware Internal-AS botnet-domains lists default-paloalto-dns action sinkhole
set shared profiles spyware Internal-AS botnet-domains lists default-paloalto-cloud packet-capture single-packet
set shared profiles spyware Internal-AS botnet-domains lists default-paloalto-cloud action sinkhole
set shared profiles spyware Internal-AS rules Block-Critical-High action reset-both
set shared profiles spyware Internal-AS rules Block-Critical-High severity [ high critical ]
set shared profiles spyware Internal-AS rules Block-Critical-High threat-name any
set shared profiles spyware Internal-AS rules Block-Critical-High category any
set shared profiles spyware Internal-AS rules Block-Critical-High packet-capture single-packet
set shared profiles spyware Internal-AS rules Default-Medium-Low-Info action default
set shared profiles spyware Internal-AS rules Default-Medium-Low-Info severity [ low informational medium ]
set shared profiles spyware Internal-AS rules Default-Medium-Low-Info threat-name any
set shared profiles spyware Internal-AS rules Default-Medium-Low-Info category any
set shared profiles spyware Internal-AS rules Default-Medium-Low-Info packet-capture disable
set shared profiles spyware Alert-Only-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set shared profiles spyware Alert-Only-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set shared profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns packet-capture disable
set shared profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns action alert
set shared profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-cloud packet-capture disable
set shared profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-cloud action alert
set shared profiles spyware Alert-Only-AS rules Alert-All action alert
set shared profiles spyware Alert-Only-AS rules Alert-All severity any
set shared profiles spyware Alert-Only-AS rules Alert-All threat-name any
set shared profiles spyware Alert-Only-AS rules Alert-All category any
set shared profiles spyware Alert-Only-AS rules Alert-All packet-capture disable
set shared profiles spyware Exception-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set shared profiles spyware Exception-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set shared profiles spyware Exception-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set shared profiles spyware Exception-AS botnet-domains lists default-paloalto-dns action sinkhole
set shared profiles spyware Exception-AS botnet-domains lists default-paloalto-cloud packet-capture single-packet
set shared profiles spyware Exception-AS botnet-domains lists default-paloalto-cloud action sinkhole
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium action reset-both
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium vendor-id any
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium severity [ critical high medium ]
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium cve any
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium threat-name any
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium host any
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium category any
set shared profiles vulnerability Outbound-VP rules Block-Critical-High-Medium packet-capture single-packet
set shared profiles vulnerability Outbound-VP rules Default-Low-Info action default
set shared profiles vulnerability Outbound-VP rules Default-Low-Info vendor-id any
set shared profiles vulnerability Outbound-VP rules Default-Low-Info severity [ low informational ]
set shared profiles vulnerability Outbound-VP rules Default-Low-Info cve any
set shared profiles vulnerability Outbound-VP rules Default-Low-Info threat-name any
set shared profiles vulnerability Outbound-VP rules Default-Low-Info host any
set shared profiles vulnerability Outbound-VP rules Default-Low-Info category any
set shared profiles vulnerability Outbound-VP rules Default-Low-Info packet-capture disable
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium action reset-both
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium vendor-id any
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium severity [ critical high medium ]
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium cve any
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium threat-name any
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium host any
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium category any
set shared profiles vulnerability Inbound-VP rules Block-Critical-High-Medium packet-capture single-packet
set shared profiles vulnerability Inbound-VP rules Default-Low-Info action default
set shared profiles vulnerability Inbound-VP rules Default-Low-Info vendor-id any
set shared profiles vulnerability Inbound-VP rules Default-Low-Info severity [ low informational ]
set shared profiles vulnerability Inbound-VP rules Default-Low-Info cve any
set shared profiles vulnerability Inbound-VP rules Default-Low-Info threat-name any
set shared profiles vulnerability Inbound-VP rules Default-Low-Info host any
set shared profiles vulnerability Inbound-VP rules Default-Low-Info category any
set shared profiles vulnerability Inbound-VP rules Default-Low-Info packet-capture disable
set shared profiles vulnerability Internal-VP rules Block-Critical-High action reset-both
set shared profiles vulnerability Internal-VP rules Block-Critical-High vendor-id any
set shared profiles vulnerability Internal-VP rules Block-Critical-High severity [ critical high ]
set shared profiles vulnerability Internal-VP rules Block-Critical-High cve any
set shared profiles vulnerability Internal-VP rules Block-Critical-High threat-name any
set shared profiles vulnerability Internal-VP rules Block-Critical-High host any
set shared profiles vulnerability Internal-VP rules Block-Critical-High category any
set shared profiles vulnerability Internal-VP rules Block-Critical-High packet-capture single-packet
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info action default
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info vendor-id any
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info severity [ low informational medium ]
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info cve any
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info threat-name any
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info host any
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info category any
set shared profiles vulnerability Internal-VP rules Default-Medium-Low-Info packet-capture disable
set shared profiles vulnerability Alert-Only-VP rules Alert-All action alert
set shared profiles vulnerability Alert-Only-VP rules Alert-All vendor-id any
set shared profiles vulnerability Alert-Only-VP rules Alert-All severity any
set shared profiles vulnerability Alert-Only-VP rules Alert-All cve any
set shared profiles vulnerability Alert-Only-VP rules Alert-All threat-name any
set shared profiles vulnerability Alert-Only-VP rules Alert-All host any
set shared profiles vulnerability Alert-Only-VP rules Alert-All category any
set shared profiles vulnerability Alert-Only-VP rules Alert-All packet-capture disable
set shared profiles vulnerability Exception-VP
set shared profiles file-blocking Outbound-FB rules Alert-All application any
set shared profiles file-blocking Outbound-FB rules Alert-All file-type any
set shared profiles file-blocking Outbound-FB rules Alert-All direction both
set shared profiles file-blocking Outbound-FB rules Alert-All action alert
set shared profiles file-blocking Outbound-FB rules Block application any
set shared profiles file-blocking Outbound-FB rules Block file-type [ 7z bat chm class cpl dll hlp hta jar ocx pif scr torrent vbe wsf ]
set shared profiles file-blocking Outbound-FB rules Block direction both
set shared profiles file-blocking Outbound-FB rules Block action block
set shared profiles file-blocking Inbound-FB rules Alert-All application any
set shared profiles file-blocking Inbound-FB rules Alert-All file-type any
set shared profiles file-blocking Inbound-FB rules Alert-All direction both
set shared profiles file-blocking Inbound-FB rules Alert-All action alert
set shared profiles file-blocking Inbound-FB rules Block application any
set shared profiles file-blocking Inbound-FB rules Block file-type [ 7z bat chm class cpl dll hlp hta jar ocx pif scr torrent vbe wsf ]
set shared profiles file-blocking Inbound-FB rules Block direction both
set shared profiles file-blocking Inbound-FB rules Block action block
set shared profiles file-blocking Internal-FB rules Alert-All application any
set shared profiles file-blocking Internal-FB rules Alert-All file-type any
set shared profiles file-blocking Internal-FB rules Alert-All direction both
set shared profiles file-blocking Internal-FB rules Alert-All action alert
set shared profiles file-blocking Internal-FB rules Block application any
set shared profiles file-blocking Internal-FB rules Block file-type [ 7z bat chm class cpl hlp hta jar ocx pif scr torrent vbe wsf ]
set shared profiles file-blocking Internal-FB rules Block direction both
set shared profiles file-blocking Internal-FB rules Block action block
set shared profiles file-blocking Alert-Only-FB rules Alert-Only application any
set shared profiles file-blocking Alert-Only-FB rules Alert-Only file-type any
set shared profiles file-blocking Alert-Only-FB rules Alert-Only direction both
set shared profiles file-blocking Alert-Only-FB rules Alert-Only action alert
set shared profiles custom-url-category Black-List
set shared profiles custom-url-category White-List
set shared profiles custom-url-category Custom-No-Decrypt
set shared profiles url-filtering Outbound-URL credential-enforcement mode ip-user
set shared profiles url-filtering Outbound-URL credential-enforcement log-severity high
set shared profiles url-filtering Outbound-URL credential-enforcement block [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting Black-List White-List ]
set shared profiles url-filtering Outbound-URL log-http-hdr-user-agent yes
set shared profiles url-filtering Outbound-URL log-http-hdr-referer yes
set shared profiles url-filtering Outbound-URL log-http-hdr-xff yes
set shared profiles url-filtering Outbound-URL alert [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting White-List  ]
set shared profiles url-filtering Outbound-URL block [ command-and-control hacking malware phishing Black-List ]
set shared profiles url-filtering Alert-Only-URL credential-enforcement mode ip-user
set shared profiles url-filtering Alert-Only-URL credential-enforcement log-severity medium
set shared profiles url-filtering Alert-Only-URL credential-enforcement alert [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting Black-List White-List ]
set shared profiles url-filtering Alert-Only-URL alert [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting Black-List White-List ]
set shared profiles url-filtering Exception-URL credential-enforcement mode ip-user
set shared profiles url-filtering Exception-URL credential-enforcement log-severity high
set shared profiles url-filtering Exception-URL credential-enforcement block [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting Black-List White-List ]
set shared profiles url-filtering Exception-URL log-http-hdr-user-agent yes
set shared profiles url-filtering Exception-URL log-http-hdr-referer yes
set shared profiles url-filtering Exception-URL log-http-hdr-xff yes
set shared profiles url-filtering Exception-URL alert [ abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy computer-and-internet-info content-delivery-networks copyright-infringement dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting White-List ]
set shared profiles url-filtering Exception-URL block [ command-and-control hacking malware phishing Black-List ]
set shared profiles wildfire-analysis Outbound-WF rules Forward-All application any
set shared profiles wildfire-analysis Outbound-WF rules Forward-All file-type any
set shared profiles wildfire-analysis Outbound-WF rules Forward-All direction both
set shared profiles wildfire-analysis Outbound-WF rules Forward-All analysis public-cloud
set shared profiles wildfire-analysis Inbound-WF rules Forward-All application any
set shared profiles wildfire-analysis Inbound-WF rules Forward-All file-type any
set shared profiles wildfire-analysis Inbound-WF rules Forward-All direction both
set shared profiles wildfire-analysis Inbound-WF rules Forward-All analysis public-cloud
set shared profiles wildfire-analysis Internal-WF rules Forward-All application any
set shared profiles wildfire-analysis Internal-WF rules Forward-All file-type any
set shared profiles wildfire-analysis Internal-WF rules Forward-All direction both
set shared profiles wildfire-analysis Internal-WF rules Forward-All analysis public-cloud
set shared profiles wildfire-analysis Alert-Only-WF rules Forward-All application any
set shared profiles wildfire-analysis Alert-Only-WF rules Forward-All file-type any
set shared profiles wildfire-analysis Alert-Only-WF rules Forward-All direction both
set shared profiles wildfire-analysis Alert-Only-WF rules Forward-All analysis public-cloud

# shared profile groups
set shared profile-group Outbound virus Outbound-AV
set shared profile-group Outbound spyware Outbound-AS
set shared profile-group Outbound vulnerability Outbound-VP
set shared profile-group Outbound url-filtering Outbound-URL
set shared profile-group Outbound file-blocking Outbound-FB
set shared profile-group Outbound wildfire-analysis Outbound-WF
set shared profile-group Inbound virus Inbound-AV
set shared profile-group Inbound spyware Inbound-AS
set shared profile-group Inbound vulnerability Inbound-VP
set shared profile-group Inbound file-blocking Inbound-FB
set shared profile-group Inbound wildfire-analysis Inbound-WF
set shared profile-group Internal virus Internal-AV
set shared profile-group Internal spyware Internal-AS
set shared profile-group Internal vulnerability Internal-VP
set shared profile-group Internal file-blocking Internal-FB
set shared profile-group Internal wildfire-analysis Internal-WF
set shared profile-group Alert-Only virus Alert-Only-AV
set shared profile-group Alert-Only spyware Alert-Only-AS
set shared profile-group Alert-Only vulnerability Alert-Only-VP
set shared profile-group Alert-Only url-filtering Alert-Only-URL
set shared profile-group Alert-Only file-blocking Alert-Only-FB
set shared profile-group Alert-Only wildfire-analysis Alert-Only-WF
set shared profile-group default virus Outbound-AV
set shared profile-group default spyware Outbound-AS
set shared profile-group default vulnerability Outbound-VP
set shared profile-group default url-filtering Outbound-URL
set shared profile-group default file-blocking Outbound-FB
set shared profile-group default wildfire-analysis Outbound-WF

# shared security and decryption rules
set shared post-rulebase default-security-rules rules intrazone-default action allow
set shared post-rulebase default-security-rules rules intrazone-default log-start no
set shared post-rulebase default-security-rules rules intrazone-default log-end yes
set shared post-rulebase default-security-rules rules intrazone-default profile-setting group Inbound
set shared post-rulebase default-security-rules rules intrazone-default log-setting default
set shared post-rulebase default-security-rules rules interzone-default action drop
set shared post-rulebase default-security-rules rules interzone-default log-start no
set shared post-rulebase default-security-rules rules interzone-default log-end yes
set shared post-rulebase default-security-rules rules interzone-default log-setting default
set shared post-rulebase decryption rules "NO-Decrypt Rule" target negate no
set shared post-rulebase decryption rules "NO-Decrypt Rule" category any
set shared post-rulebase decryption rules "NO-Decrypt Rule" service any
set shared post-rulebase decryption rules "NO-Decrypt Rule" type ssl-forward-proxy
set shared post-rulebase decryption rules "NO-Decrypt Rule" from any
set shared post-rulebase decryption rules "NO-Decrypt Rule" to any
set shared post-rulebase decryption rules "NO-Decrypt Rule" source any
set shared post-rulebase decryption rules "NO-Decrypt Rule" destination any
set shared post-rulebase decryption rules "NO-Decrypt Rule" source-user any
set shared post-rulebase decryption rules "NO-Decrypt Rule" profile Recommended_Decryption_Profile
set shared post-rulebase decryption rules "NO-Decrypt Rule" action no-decrypt
set shared post-rulebase decryption rules "NO-Decrypt Rule" description "This rule does not do Decryption.  This rule is validating SSL Protocol Communications."
set shared pre-rulebase security rules "Outbound Block Rule" description "Block outbound sessions with destination address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses."
set shared pre-rulebase security rules "Outbound Block Rule" target negate no
set shared pre-rulebase security rules "Outbound Block Rule" to any
set shared pre-rulebase security rules "Outbound Block Rule" from any
set shared pre-rulebase security rules "Outbound Block Rule" source any
set shared pre-rulebase security rules "Outbound Block Rule" destination [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list ]
set shared pre-rulebase security rules "Outbound Block Rule" source-user any
set shared pre-rulebase security rules "Outbound Block Rule" category any
set shared pre-rulebase security rules "Outbound Block Rule" application any
set shared pre-rulebase security rules "Outbound Block Rule" service any
set shared pre-rulebase security rules "Outbound Block Rule" hip-profiles any
set shared pre-rulebase security rules "Outbound Block Rule" action deny
set shared pre-rulebase security rules "Outbound Block Rule" log-setting default
set shared pre-rulebase security rules "Outbound Block Rule" tag Outbound
set shared pre-rulebase security rules "Inbound Block Rule" description "Block inbound sessions with source address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses."
set shared pre-rulebase security rules "Inbound Block Rule" target negate no
set shared pre-rulebase security rules "Inbound Block Rule" to any
set shared pre-rulebase security rules "Inbound Block Rule" from any
set shared pre-rulebase security rules "Inbound Block Rule" source [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list ]
set shared pre-rulebase security rules "Inbound Block Rule" destination any
set shared pre-rulebase security rules "Inbound Block Rule" source-user any
set shared pre-rulebase security rules "Inbound Block Rule" category any
set shared pre-rulebase security rules "Inbound Block Rule" application any
set shared pre-rulebase security rules "Inbound Block Rule" service any
set shared pre-rulebase security rules "Inbound Block Rule" hip-profiles any
set shared pre-rulebase security rules "Inbound Block Rule" action deny
set shared pre-rulebase security rules "Inbound Block Rule" log-setting default
set shared pre-rulebase security rules "Inbound Block Rule" tag Inbound
set shared pre-rulebase security rules "DNS Sinkhole Block" description "Block outbound sessions that match a malicious domain and have been redirected to a configured sinkhole IP address."
set shared pre-rulebase security rules "DNS Sinkhole Block" target negate no
set shared pre-rulebase security rules "DNS Sinkhole Block" to any
set shared pre-rulebase security rules "DNS Sinkhole Block" from any
set shared pre-rulebase security rules "DNS Sinkhole Block" source any
set shared pre-rulebase security rules "DNS Sinkhole Block" destination [ Sinkhole-IPv4 Sinkhole-IPv6 ]
set shared pre-rulebase security rules "DNS Sinkhole Block" source-user any
set shared pre-rulebase security rules "DNS Sinkhole Block" category any
set shared pre-rulebase security rules "DNS Sinkhole Block" application any
set shared pre-rulebase security rules "DNS Sinkhole Block" service any
set shared pre-rulebase security rules "DNS Sinkhole Block" hip-profiles any
set shared pre-rulebase security rules "DNS Sinkhole Block" action deny
set shared pre-rulebase security rules "DNS Sinkhole Block" log-setting default
set shared pre-rulebase security rules "DNS Sinkhole Block" tag Outbound
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" target negate no
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" category [ financial-services government health-and-medicine Custom-No-Decrypt ]
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" service any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" type ssl-forward-proxy
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" from any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" to any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" source any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" destination any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" source-user any
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" profile Recommended_Decryption_Profile
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" action no-decrypt
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" disabled yes
set shared pre-rulebase decryption rules "NO-Decrypt URL Categories" description "This rule does not do Decryption.  This rule is validating SSL Protocol Communications."

# shared template configuration referenced in template stacks
set template iron-skillet settings default-vsys vsys1
set template iron-skillet config vsys vsys1
set template iron-skillet config mgt-config users admin phash $1$GmGy8oJJ$V75cNdSRDx0V78yJqXZ111
set template iron-skillet config mgt-config users admin permissions role-based superuser yes
set template iron-skillet config mgt-config password-complexity enabled yes
set template iron-skillet config mgt-config password-complexity minimum-length 12
set template iron-skillet config mgt-config password-complexity minimum-uppercase-letters 1
set template iron-skillet config mgt-config password-complexity minimum-lowercase-letters 1
set template iron-skillet config mgt-config password-complexity minimum-numeric-letters 1
set template iron-skillet config mgt-config password-complexity minimum-special-characters 1
set template iron-skillet config mgt-config password-complexity block-username-inclusion yes
set template iron-skillet config mgt-config password-complexity password-history-count 24
set template iron-skillet config mgt-config password-complexity new-password-differs-by-characters 3
set template iron-skillet config mgt-config password-complexity password-change expiration-period 90
set template iron-skillet config deviceconfig system update-schedule statistics-service application-reports yes
set template iron-skillet config deviceconfig system update-schedule statistics-service threat-prevention-reports yes
set template iron-skillet config deviceconfig system update-schedule statistics-service threat-prevention-pcap yes
set template iron-skillet config deviceconfig system update-schedule statistics-service threat-prevention-information yes
set template iron-skillet config deviceconfig system update-schedule statistics-service passive-dns-monitoring yes
set template iron-skillet config deviceconfig system update-schedule statistics-service url-reports yes
set template iron-skillet config deviceconfig system update-schedule statistics-service health-performance-reports yes
set template iron-skillet config deviceconfig system update-schedule statistics-service file-identification-reports yes
set template iron-skillet config deviceconfig system update-schedule threats recurring every-30-mins at 2
set template iron-skillet config deviceconfig system update-schedule threats recurring every-30-mins action download-and-install
set template iron-skillet config deviceconfig system update-schedule threats recurring threshold 48
set template iron-skillet config deviceconfig system update-schedule anti-virus recurring hourly at 4
set template iron-skillet config deviceconfig system update-schedule anti-virus recurring hourly action download-and-install
set template iron-skillet config deviceconfig system update-schedule wildfire recurring every-min action download-and-install
set template iron-skillet config deviceconfig system update-schedule global-protect-datafile recurring hourly at 40
set template iron-skillet config deviceconfig system update-schedule global-protect-datafile recurring hourly action download-and-install
set template iron-skillet config deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly at 50
set template iron-skillet config deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly action download-and-install
set template iron-skillet config deviceconfig system snmp-setting access-setting version v3
set template iron-skillet config deviceconfig system dns-setting servers primary 8.8.8.8
set template iron-skillet config deviceconfig system dns-setting servers secondary 8.8.4.4
set template iron-skillet config deviceconfig system ntp-servers primary-ntp-server ntp-server-address 0.pool.ntp.org
set template iron-skillet config deviceconfig system ntp-servers secondary-ntp-server ntp-server-address 1.pool.ntp.org
set template iron-skillet config deviceconfig system login-banner "You have accessed a protected system.Log off immediately if you are not an authorized user."
set template iron-skillet config deviceconfig system timezone UTC
set template iron-skillet config deviceconfig setting ctd strip-x-fwd-for yes
set template iron-skillet config deviceconfig setting ctd x-forwarded-for yes
set template iron-skillet config deviceconfig setting ctd allow-http-range no
set template iron-skillet config deviceconfig setting ctd tcp-bypass-exceed-queue no
set template iron-skillet config deviceconfig setting ctd udp-bypass-exceed-queue no
set template iron-skillet config deviceconfig setting management enable-log-high-dp-load yes
set template iron-skillet config deviceconfig setting management api key lifetime 525600
set template iron-skillet config deviceconfig setting management max-rows-in-csv-export 1048576
set template iron-skillet config deviceconfig setting management admin-lockout failed-attempts 5
set template iron-skillet config deviceconfig setting management admin-lockout lockout-time 30
set template iron-skillet config deviceconfig setting management idle-timeout 10
set template iron-skillet config deviceconfig setting management auto-acquire-commit-lock yes
set template iron-skillet config deviceconfig setting wildfire file-size-limit pe size-limit 10
set template iron-skillet config deviceconfig setting wildfire file-size-limit apk size-limit 30
set template iron-skillet config deviceconfig setting wildfire file-size-limit pdf size-limit 1000
set template iron-skillet config deviceconfig setting wildfire file-size-limit ms-office size-limit 2000
set template iron-skillet config deviceconfig setting wildfire file-size-limit jar size-limit 5
set template iron-skillet config deviceconfig setting wildfire file-size-limit flash size-limit 5
set template iron-skillet config deviceconfig setting wildfire file-size-limit MacOSX size-limit 1
set template iron-skillet config deviceconfig setting wildfire file-size-limit archive size-limit 10
set template iron-skillet config deviceconfig setting wildfire file-size-limit linux size-limit 2
set template iron-skillet config deviceconfig setting wildfire file-size-limit script size-limit 2000
set template iron-skillet config deviceconfig setting wildfire report-benign-file yes
set template iron-skillet config deviceconfig setting wildfire report-grayware-file yes
set template iron-skillet config deviceconfig setting config rematch yes
set template iron-skillet config deviceconfig setting application notify-user yes
set template iron-skillet config deviceconfig setting application bypass-exceed-queue no
set template iron-skillet config deviceconfig setting logging log-suppression no
set template iron-skillet config deviceconfig setting tcp urgent-data clear
set template iron-skillet config deviceconfig setting tcp drop-zero-flag yes
set template iron-skillet config deviceconfig setting tcp bypass-exceed-oo-queue no
set template iron-skillet config deviceconfig setting tcp check-timestamp-option yes
set template iron-skillet config deviceconfig setting tcp strip-mptcp-option yes
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection flood udp enable no
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 action alert
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 interval 2
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 threshold 100
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 action alert
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 interval 10
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 threshold 100
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 action alert
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 interval 2
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 threshold 100
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection discard-ip-spoof yes
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection discard-malformed-option yes
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection remove-tcp-timestamp yes
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection strip-tcp-fast-open-and-data no
set template iron-skillet config network profiles zone-protection-profile Recommended_Zone_Protection strip-mptcp-option global
set template iron-skillet config shared log-settings email Sample_Email_Profile server Sample_Email_Profile display-name Panorama
set template iron-skillet config shared log-settings email Sample_Email_Profile server Sample_Email_Profile gateway 192.0.2.1
set template iron-skillet config shared log-settings email Sample_Email_Profile server Sample_Email_Profile from sentfrom@yourdomain.com
set template iron-skillet config shared log-settings email Sample_Email_Profile server Sample_Email_Profile to sendto@yourdomain.com
set template iron-skillet config shared log-settings syslog Sample_Syslog_Profile server Sample_Syslog transport UDP
set template iron-skillet config shared log-settings syslog Sample_Syslog_Profile server Sample_Syslog port 514
set template iron-skillet config shared log-settings syslog Sample_Syslog_Profile server Sample_Syslog format BSD
set template iron-skillet config shared log-settings syslog Sample_Syslog_Profile server Sample_Syslog server 192.0.2.2
set template iron-skillet config shared log-settings syslog Sample_Syslog_Profile server Sample_Syslog facility LOG_USER
set template iron-skillet config shared log-settings system match-list System_Log_Forwarding filter "All Logs"
set template iron-skillet config shared log-settings system match-list System_Log_Forwarding send-to-panorama yes
set template iron-skillet config shared log-settings config match-list Configuration_Log_Forwarding filter "All Logs"
set template iron-skillet config shared log-settings config match-list Configuration_Log_Forwarding send-to-panorama yes
set template iron-skillet config shared log-settings userid match-list User-ID_Log_Forwarding filter "All Logs"
set template iron-skillet config shared log-settings userid match-list User-ID_Log_Forwarding send-to-panorama yes
set template iron-skillet config shared log-settings hipmatch match-list HIP_Log_Forwarding filter "All Logs"
set template iron-skillet config shared log-settings hipmatch match-list HIP_Log_Forwarding send-to-panorama yes
set template iron-skillet config shared log-settings correlation match-list Correlation_Log_Forwarding send-syslog Sample_Syslog_Profile
set template iron-skillet config shared log-settings correlation match-list Correlation_Log_Forwarding filter "All Logs"

# template-stack configuration for device specific configuration
# NOTE: must determine if fw management IP is static or dhcp then choose which set commands to enter
set template-stack sample_stack templates iron-skillet
set template-stack sample_stack settings default-vsys vsys1
set template-stack sample_stack config devices localhost.localdomain deviceconfig system hostname sample

### management interface type is DHCP
set template-stack sample_stack config devices localhost.localdomain deviceconfig system type dhcp-client send-hostname yes
set template-stack sample_stack config devices localhost.localdomain deviceconfig system type dhcp-client send-client-id no
set template-stack sample_stack config devices localhost.localdomain deviceconfig system type dhcp-client accept-dhcp-hostname no
set template-stack sample_stack config devices localhost.localdomain deviceconfig system type dhcp-client accept-dhcp-domain no

### management interface type is static
set template-stack sample_stack config devices localhost.localdomain deviceconfig system type static
set template-stack sample_stack config devices localhost.localdomain deviceconfig system ip-address 192.0.2.6
set template-stack sample_stack config devices localhost.localdomain deviceconfig system netmask 255.255.128.0
set template-stack sample_stack config devices localhost.localdomain deviceconfig system default-gateway 192.0.2.7

set device-group sample_devicegroup reports "Host-visit malicious sites plus" period last-7-calendar-days
set device-group sample_devicegroup reports "Host-visit malicious sites plus" topn 500
set device-group sample_devicegroup reports "Host-visit malicious sites plus" topm 50
set device-group sample_devicegroup reports "Host-visit malicious sites plus" caption "Host-visit malicious sites plus"
set device-group sample_devicegroup reports "Host-visit malicious sites plus" frequency daily
set device-group sample_devicegroup reports "Host-visit malicious sites plus" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing)"
set device-group sample_devicegroup reports "Host-visit malicious sites plus" type panorama-url sortby repeatcnt
set device-group sample_devicegroup reports "Host-visit malicious sites plus" type panorama-url group-by src
set device-group sample_devicegroup reports "Host-visit malicious sites plus" type panorama-url aggregate-by [ from srcuser category action ]
set device-group sample_devicegroup reports "Host-visit malicious sites plus" type panorama-url values repeatcnt
set device-group sample_devicegroup reports "Hosts visit malicious sites" period last-7-calendar-days
set device-group sample_devicegroup reports "Hosts visit malicious sites" topn 500
set device-group sample_devicegroup reports "Hosts visit malicious sites" topm 50
set device-group sample_devicegroup reports "Hosts visit malicious sites" caption "Hosts visit malicious sites"
set device-group sample_devicegroup reports "Hosts visit malicious sites" frequency daily
set device-group sample_devicegroup reports "Hosts visit malicious sites" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing)"
set device-group sample_devicegroup reports "Hosts visit malicious sites" type panorama-url sortby repeatcnt
set device-group sample_devicegroup reports "Hosts visit malicious sites" type panorama-url group-by src
set device-group sample_devicegroup reports "Hosts visit malicious sites" type panorama-url aggregate-by [ from srcuser ]
set device-group sample_devicegroup reports "Hosts visit malicious sites" type panorama-url values repeatcnt
set device-group sample_devicegroup reports "Hosts visit questionable sites" period last-7-calendar-days
set device-group sample_devicegroup reports "Hosts visit questionable sites" topn 500
set device-group sample_devicegroup reports "Hosts visit questionable sites" topm 50
set device-group sample_devicegroup reports "Hosts visit questionable sites" caption "Hosts visit questionable sites"
set device-group sample_devicegroup reports "Hosts visit questionable sites" frequency daily
set device-group sample_devicegroup reports "Hosts visit questionable sites" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set device-group sample_devicegroup reports "Hosts visit questionable sites" type panorama-url sortby repeatcnt
set device-group sample_devicegroup reports "Hosts visit questionable sites" type panorama-url group-by src
set device-group sample_devicegroup reports "Hosts visit questionable sites" type panorama-url aggregate-by [ from srcuser ]
set device-group sample_devicegroup reports "Hosts visit questionable sites" type panorama-url values repeatcnt
set device-group sample_devicegroup reports "Host-visit quest sites plus" period last-7-calendar-days
set device-group sample_devicegroup reports "Host-visit quest sites plus" topn 500
set device-group sample_devicegroup reports "Host-visit quest sites plus" topm 50
set device-group sample_devicegroup reports "Host-visit quest sites plus" caption "Host-visit quest sites plus"
set device-group sample_devicegroup reports "Host-visit quest sites plus" frequency daily
set device-group sample_devicegroup reports "Host-visit quest sites plus" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set device-group sample_devicegroup reports "Host-visit quest sites plus" description "Detail of hosts visiting questionable URLs"
set device-group sample_devicegroup reports "Host-visit quest sites plus" type panorama-url sortby repeatcnt
set device-group sample_devicegroup reports "Host-visit quest sites plus" type panorama-url group-by src
set device-group sample_devicegroup reports "Host-visit quest sites plus" type panorama-url aggregate-by [ from srcuser category action ]
set device-group sample_devicegroup reports "Host-visit quest sites plus" type panorama-url values repeatcnt
set device-group sample_devicegroup reports "Wildfire malicious verdicts" period last-30-calendar-days
set device-group sample_devicegroup reports "Wildfire malicious verdicts" topn 500
set device-group sample_devicegroup reports "Wildfire malicious verdicts" topm 10
set device-group sample_devicegroup reports "Wildfire malicious verdicts" caption "Wildfire malicious verdicts"
set device-group sample_devicegroup reports "Wildfire malicious verdicts" frequency daily
set device-group sample_devicegroup reports "Wildfire malicious verdicts" query "(app neq smtp) and (category neq benign)"
set device-group sample_devicegroup reports "Wildfire malicious verdicts" description "Files uploaded or downloaded that were later found to be malicious. This is a summary. Act on real-time email."
set device-group sample_devicegroup reports "Wildfire malicious verdicts" type panorama-wildfire sortby repeatcnt
set device-group sample_devicegroup reports "Wildfire malicious verdicts" type panorama-wildfire aggregate-by [ filedigest container-of-app app category filetype rule ]
set device-group sample_devicegroup reports "Wildfire malicious verdicts" type panorama-wildfire values repeatcnt
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" period last-30-calendar-days
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" topn 500
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" topm 10
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" caption "Wildfire verdicts SMTP"
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" frequency daily
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" query "(app eq smtp) and (category neq benign)"
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" description "Links sent from emails found to be malicious. "
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" type panorama-wildfire sortby repeatcnt
set device-group sample_devicegroup reports "Wildfire verdicts SMTP" type panorama-wildfire aggregate-by [ filedigest container-of-app app category filetype rule subject sender recipient misc ]
set device-group sample_devicegroup reports "Clients sinkholed" period last-30-calendar-days
set device-group sample_devicegroup reports "Clients sinkholed" topn 500
set device-group sample_devicegroup reports "Clients sinkholed" topm 50
set device-group sample_devicegroup reports "Clients sinkholed" caption "Clients sinkholed"
set device-group sample_devicegroup reports "Clients sinkholed" query "(rule eq 'DNS Sinkhole Block')"
set device-group sample_devicegroup reports "Clients sinkholed" frequency daily
set device-group sample_devicegroup reports "Clients sinkholed" type panorama-traffic sortby repeatcnt
set device-group sample_devicegroup reports "Clients sinkholed" type panorama-traffic group-by from
set device-group sample_devicegroup reports "Clients sinkholed" type panorama-traffic aggregate-by [ src srcuser ]
set device-group sample_devicegroup reports "Clients sinkholed" type panorama-traffic values repeatcnt
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 1 custom-report "Clients sinkholed"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 2 custom-report "Wildfire malicious verdicts"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 3 custom-report "Wildfire verdicts SMTP"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 4 custom-report "Hosts visit malicious sites"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 5 custom-report "Host-visit malicious sites plus"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 6 custom-report "Hosts visit questionable sites"
set device-group sample_devicegroup report-group "Possible Compromise" custom-widget 7 custom-report "Host-visit quest sites plus"
set device-group sample_devicegroup report-group "Possible Compromise" title-page yes
set device-group sample_devicegroup report-group "Possible Compromise" variable title value "Possible Compromise"
set device-group sample_devicegroup email-scheduler "Possible Compromise" report-group "Possible Compromise"
set device-group sample_devicegroup email-scheduler "Possible Compromise" recurring disabled
set device-group sample_devicegroup email-scheduler "Possible Compromise" email-profile Sample_Email_Profile

# log collector group info
set log-collector-group Default_Collector_Group monitoring-setting snmp-setting access-setting version v2c
set log-collector-group Default_Collector_Group log-settings system match-list Email_Critical_System_Logs send-email Sample_Email_Profile
set log-collector-group Default_Collector_Group log-settings system match-list Email_Critical_System_Logs filter "(severity eq critical)"
set log-collector-group Default_Collector_Group log-settings system match-list Email_Critical_System_Logs description "Email Critical System Logs"
set log-collector-group Default_Collector_Group log-settings system match-list Syslog_System_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings system match-list Syslog_System_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings system match-list Syslog_System_Logs description "Syslog All System Logs"
set log-collector-group Default_Collector_Group log-settings config match-list Syslog_Config_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings config match-list Syslog_Config_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings hipmatch match-list Syslog_HIP_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings hipmatch match-list Syslog_HIP_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings hipmatch match-list Syslog_HIP_Logs description "Syslog All HIP Logs"
set log-collector-group Default_Collector_Group log-settings traffic match-list Syslog_Traffic_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings traffic match-list Syslog_Traffic_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings traffic match-list Syslog_Traffic_Logs description "Syslog All Traffic Logs"
set log-collector-group Default_Collector_Group log-settings threat match-list Syslog_Threat_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings threat match-list Syslog_Threat_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings threat match-list Syslog_Threat_Logs description "Syslog All Threat Logs"
set log-collector-group Default_Collector_Group log-settings url match-list Syslog_URL_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings url match-list Syslog_URL_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings url match-list Syslog_URL_Logs description "Syslog All URL Logs"
set log-collector-group Default_Collector_Group log-settings data match-list Syslog_Data_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings data match-list Syslog_Data_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings data match-list Syslog_Data_Logs description "Syslog All Data Logs"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Malicious_Verdicts send-email Sample_Email_Profile
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Malicious_Verdicts filter "(verdict eq malicious)"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Malicious_Verdicts description "Email Malicious WildFire Verdicts"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Phishing_Verdicts send-email Sample_Email_Profile
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Phishing_Verdicts filter "(verdict eq phishing)"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Email_Phishing_Verdicts description "Email All Phishing Verdicts"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Syslog_WildFire_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings wildfire match-list Syslog_WildFire_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings wildfire match-list Syslog_WildFire_Logs description "Syslog All WildFire Logs"
set log-collector-group Default_Collector_Group log-settings correlation match-list Email_Critical_Correlations send-email Sample_Email_Profile
set log-collector-group Default_Collector_Group log-settings correlation match-list Email_Critical_Correlations filter "(severity geq medium)"
set log-collector-group Default_Collector_Group log-settings correlation match-list Email_Critical_Correlations description "Emal all Critical Correlation Events"
set log-collector-group Default_Collector_Group log-settings correlation match-list Syslog_Correlation_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings correlation match-list Syslog_Correlation_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings correlation match-list Syslog_Correlation_Logs description "Syslog All Correlation Logs"
set log-collector-group Default_Collector_Group log-settings auth match-list Syslog_Auth_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings auth match-list Syslog_Auth_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings auth match-list Syslog_Auth_Logs description "Syslog All Authentication Logs"
set log-collector-group Default_Collector_Group log-settings userid match-list Syslog_User-ID_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings userid match-list Syslog_User-ID_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings userid match-list Syslog_User-ID_Logs description "Syslog All User-ID Logs"
set log-collector-group Default_Collector_Group log-settings tunnel match-list Syslog_Tunnel_Logs send-syslog Sample_Syslog_Profile
set log-collector-group Default_Collector_Group log-settings tunnel match-list Syslog_Tunnel_Logs filter "All Logs"
set log-collector-group Default_Collector_Group log-settings tunnel match-list Syslog_Tunnel_Logs description "Syslog All Tunnel Logs"
set log-collector-group Default_Collector_Group logfwd-setting
set log-collector-group Default_Collector_Group general-setting management quota-settings